#!/bin/sh

set -e

export NOTIFY_LONG=unicode
export NOTIFY_SHORT="${0##*/}"

setup()
{
	curl 'https://www.unicode.org/Public/UNIDATA/UnicodeData.txt' \
	| >"$DATA" sed -E                                             \
		-e 's/;[^;]*//2g'                                         \
		-e 's/\<(.)([A-Z]*)/\1\L\2/2g'                            \
		-e '/^[^;]*;</d'                                          \
		-e '/Compatibility/d'                                     \
		-e '/Variation Selector/d'                                \
		-e 's/[^;]*/\\\\u&/'
}

readonly DATA="${XDG_DATA_HOME:-$HOME/.local/share}/unicode-data"
[ -f "$DATA" ] || setup

opt="$(cut -d';' -f2 "$DATA" | osel)"
rune="$(awk -vopt="$opt" -F';' '$2 == opt { print $1 }' "$DATA" | xargs printf)"

wl-copy -n "$rune" \
&& notify 'Rune Copied' "The rune ‘$rune’ was copied to the clipboard"
